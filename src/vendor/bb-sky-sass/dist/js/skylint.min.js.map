{"version":3,"file":"skylint.min.js","sources":["../../js/sky/linter/skylint.js"],"names":["getElText","el","text","each","push","clone","outerHTML","join","createError","code","message","findDeprecatedDirectives","msgs","deprecatedDirective","deprecatedEls","i","msg","n","deprecatedDirectives","length","find","findDeprecatedClasses","deprecatedClass","deprecatedClasses","sendMessage","args","slice","call","arguments","window","alert","JSON","stringify","lintSingle","$","path","data","errors","versionCompare","v1","v2","isValidPart","x","test","v1parts","split","v2parts","every","NaN","map","Number","lintAll","els","minVersion","REPORTER_VERSION","this","ex"],"mappings":"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","sourcesContent":["/*jshint browser: true */\n/*global REPORTER_VERSION, $ */\n\n(function () {\n    'use strict';\n\n    var deprecatedClasses = [\n            ['sky-icon-multi-action', 'use the bb-context-menu-directive for context menu button styling'],\n            ['title', 'bb-tooltip-title'],\n            ['tooltip-container', null, 'native tooltip styles are overridden so this class is unnecessary'],\n            ['page-tooltip', null, 'native tooltip styles are overridden so this class is unnecessary'],\n            ['checklist-checkbox-column', 'bb-checklist-checkbox-column'],\n            ['checklist-filter-bar', 'bb-checklist-filter-bar'],\n            ['checklist-no-items', 'bb-checklist-no-items'],\n            ['checklist-link', 'bb-checklist-link'],\n            ['checklist-row', 'bb-checklist-row'],\n            ['checklist-wrapper', 'bb-checklist-wrapper'],\n            ['description-column', 'bb-checklist-description-column'],\n            ['name-column', 'bb-checklist-name-column'],\n            ['add-button', 'bb-grid-toolbar-btn-add'],\n            ['applied-filter-bar', 'bb-applied-filter-bar'],\n            ['applied-filter-content', 'bb-applied-filter-content'],\n            ['applied-filter-header', 'bb-applied-filter-header'],\n            ['applied-filter-remove', 'bb-applied-filter-remove'],\n            ['applied-filter-text', 'bb-applied-filter-text'],\n            ['column-picker-button-icon', 'bb-column-picker-btn-icon'],\n            ['filter-button-icon', 'bb-filter-btn-icon'],\n            ['grid-action-bar', 'bb-grid-action-bar'],\n            ['grid-action-bar-and-back-to-top', 'bb-grid-action-bar-and-back-to-top'],\n            ['grid-action-bar-buttons', 'bb-grid-action-bar-buttons'],\n            ['grid-action-bar-clear-selection', 'bb-grid-action-bar-clear-selection'],\n            ['grid-action-bar-mobile-btn', 'bb-grid-action-bar-mobile-btn'],\n            ['grid-action-bar-mobile-cancel', 'bb-grid-action-bar-mobile-cancel'],\n            ['grid-action-bar-mobile-buttons', 'bb-grid-action-bar-mobile-buttons'],\n            ['grid-action-bar-btn-container', 'bb-grid-action-bar-btn-container'],\n            ['grid-column-picker-wrapper', 'bb-grid-column-picker-wrapper'],\n            ['grid-column-picker-table', 'bb-grid-column-picker-table'],\n            ['grid-filter-summary-item', 'bb-grid-filter-summary-item'],\n            ['grid-filters', 'bb-grid-filters'],\n            ['grid-filters-body', 'bb-grid-filters-body'],\n            ['grid-filters-body-group-content', 'bb-grid-filters-body-group-content'],\n            ['grid-filters-body-group-header-icon', 'bb-grid-filters-body-group-header-icon'],\n            ['grid-filters-box', 'bb-grid-filters-box'],\n            ['grid-filters-container', 'bb-grid-filters-container'],\n            ['grid-filters-fixed-bottom', 'bb-grid-filters-fixed-bottom'],\n            ['grid-filters-fixed-top', 'bb-grid-filters-fixed-top'],\n            ['grid-filters-footer', 'bb-grid-filters-footer'],\n            ['grid-filters-header', 'bb-grid-filters-header'],\n            ['grid-filters-header-hide', 'bb-grid-filters-header-hide'],\n            ['grid-filters-header-title', 'bb-grid-filters-header-title'],\n            ['grid-filters-icon', 'bb-grid-filters-icon'],\n            ['grid-toolbar-container', 'bb-grid-toolbar-container'],\n            ['search-container', 'bb-search-container'],\n            ['search-icon', 'bb-search-icon'],\n            ['table-backtotop', 'bb-table-backtotop'],\n            ['table-loadmore', 'bb-table-loadmore'],\n            ['table-toolbar', 'bb-table-toolbar'],\n            ['tile', 'bb-tile'],\n            ['tile-header', 'bb-tile-header'],\n            ['tile-content-section', 'bb-tile-content-section'],\n            ['tile-chevron', 'bb-tile-chevron'],\n            ['tile-grab-handle', 'bb-tile-grab-handle'],\n            ['tile-toolbar', 'bb-tile-toolbar'],\n            ['toolbar-button', 'bb-toolbar-btn'],\n            ['toolbar-button-icon', 'bb-toolbar-btn-icon'],\n            ['toolbar-button-label', 'bb-toolbar-btn-label'],\n            ['viewkeeper-fixed', 'bb-viewkeeper-fixed'],\n            ['viewkeeper-ignore-fixed', 'bb-viewkeeper-ignore-fixed']\n        ],\n        deprecatedDirectives = [\n            ['bb-chart-scatterplot'],\n            ['bb-date-field', 'bb-datepicker'],\n            ['bb-helpwidget', null, 'Use the \"bbHelp\" service instead to show the help panel from a controller.'],\n            ['bb-money-input', 'bb-autonumeric'],\n            ['bb-tab', null, 'Use the Angular UI Bootstrap \"tabset\" directive along with the \"bb-tab-scroll\" and \"bb-tab-sref\" directives if needed.']\n        ];\n\n    function getElText(el) {\n        var text = [];\n\n        el.each(function () {\n            text.push(el.clone().text('...')[0].outerHTML);\n        });\n\n        return '\\n    ' + text.join('    \\n');\n    }\n\n    function createError(code, message) {\n        return {\n            code: code,\n            message: message\n        };\n    }\n\n    function findDeprecatedDirectives(el, msgs) {\n        var deprecatedDirective,\n            deprecatedEls,\n            i,\n            msg,\n            n;\n\n        for (i = 0, n = deprecatedDirectives.length; i < n; i++) {\n            deprecatedDirective = deprecatedDirectives[i];\n\n            deprecatedEls = el.find(deprecatedDirective[0] + ', [' + deprecatedDirective[0] + ']');\n\n            if (deprecatedEls.length > 0) {\n                msg = 'The directive \"' + deprecatedDirective[0] + '\" is deprecated.';\n\n                switch (deprecatedDirective.length) {\n                    case 3:\n                        msg += '  ' + deprecatedDirective[2];\n                        break;\n                    case 2:\n                        msg += '  Use \"' + deprecatedDirective[1] + '\" instead.';\n                        break;\n                }\n\n                msg += getElText(deprecatedEls);\n\n                msgs.push(createError('E0001', msg));\n            }\n        }\n    }\n\n    function findDeprecatedClasses(el, msgs) {\n        var deprecatedClass,\n            deprecatedEls,\n            i,\n            n;\n\n        for (i = 0, n = deprecatedClasses.length; i < n; i++) {\n            deprecatedClass = deprecatedClasses[i];\n\n            deprecatedEls = el.find('.' + deprecatedClass[0]);\n\n            if (deprecatedEls.length > 0) {\n                msgs.push(\n                    createError(\n                        'E0002',\n                        'The CSS class \"' + deprecatedClass[0] + '\" is deprecated.  Use \"' + deprecatedClass[1] + '\" instead.' + getElText(deprecatedEls)\n                    )\n                );\n            }\n        }\n    }\n\n    // Send messages to the parent PhantomJS process via alert! Good times!!\n    function sendMessage() {\n        var args = [].slice.call(arguments);\n        window.alert(JSON.stringify(args));\n    }\n\n    function lintSingle(el) {\n        var msgs = [];\n\n        el = $(el);\n\n        findDeprecatedDirectives(el, msgs);\n        findDeprecatedClasses(el, msgs);\n\n        if (msgs.length > 0) {\n            sendMessage('skylint.invalid', {\n                path: el.data('path'),\n                errors: msgs\n            });\n        }\n    }\n\n    function versionCompare(v1, v2) {\n        var i,\n            v1parts = v1.split('.'),\n            v2parts = v2.split('.');\n\n        function isValidPart(x) {\n            return /^\\d+$/.test(x);\n        }\n\n        if (!v1parts.every(isValidPart) || !v2parts.every(isValidPart)) {\n            return NaN;\n        }\n\n        v1parts = v1parts.map(Number);\n        v2parts = v2parts.map(Number);\n\n        for (i = 0; i < v1parts.length; ++i) {\n            if (v2parts.length === i) {\n                return 1;\n            }\n\n            if (v1parts[i] !== v2parts[i]) {\n                if (v1parts[i] > v2parts[i]) {\n                    return 1;\n                } else {\n                    return -1;\n                }\n            }\n        }\n\n        if (v1parts.length !== v2parts.length) {\n            return -1;\n        }\n\n        return 0;\n    }\n\n    function lintAll() {\n        var els,\n            minVersion = '0.1.0';\n\n        if (versionCompare(REPORTER_VERSION, minVersion) < 0) {\n            sendMessage('skylint.error', 'Your Skylint Grunt task is out of date.  Upgrade your Grunt task to ' + minVersion + ' or later to continue to use Skylint.');\n            return;\n        }\n\n        try {\n            els = $('.thing-to-test');\n\n            sendMessage('skylint.ok', 'Testing ' + els.length + ' file(s)...');\n\n            els.each(function () {\n                lintSingle(this);\n            });\n        } catch (ex) {\n            sendMessage('skylint.error', ex.message);\n        }\n    }\n\n    lintAll();\n\n    sendMessage('skylint.done');\n}());\n"]}